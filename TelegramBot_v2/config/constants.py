"""
Константы приложения.

Содержит все magic numbers и конфигурационные значения,
используемые в кодовой базе.
"""

from typing import Final


# ============================================================
# ГЕНЕРАЦИЯ И ФОТО
# ============================================================

# Максимальное количество фото для одной генерации
MAX_PHOTOS_PER_GENERATION: Final[int] = 5

# Максимальный размер файла фото (в байтах, 10 МБ)
MAX_PHOTO_SIZE_BYTES: Final[int] = 10 * 1024 * 1024

# Максимальная длина описания к фото (символов)
MAX_PHOTO_DESCRIPTION_LENGTH: Final[int] = 500


# ============================================================
# ПАГИНАЦИЯ
# ============================================================

# Количество элементов на странице в админ-панели
ITEMS_PER_PAGE: Final[int] = 10

# Количество элементов на странице в истории пользователя
HISTORY_ITEMS_PER_PAGE: Final[int] = 5


# ============================================================
# ЛИМИТЫ И ОГРАНИЧЕНИЯ
# ============================================================

# Максимальное количество кредитов для разовой выдачи/списания
MAX_CREDIT_OPERATION_AMOUNT: Final[int] = 10000

# Минимальное количество кредитов для операции
MIN_CREDIT_OPERATION_AMOUNT: Final[int] = 1

# Количество бесплатных кредитов для новых пользователей (по умолчанию)
DEFAULT_FREE_CREDITS: Final[int] = 1

# Максимальная длина username для отображения
MAX_USERNAME_DISPLAY_LENGTH: Final[int] = 30

# Максимальная длина сообщения в Telegram
MAX_MESSAGE_LENGTH: Final[int] = 4000

# Длина превью ТЗ
PREVIEW_LENGTH: Final[int] = 1000

# Rate limiting по умолчанию (секунды между запросами)
DEFAULT_RATE_LIMIT: Final[float] = 0.5


# ============================================================
# ВРЕМЕННЫЕ ФАЙЛЫ
# ============================================================

# Максимальный возраст временных файлов для очистки (часы)
TEMP_FILES_MAX_AGE_HOURS: Final[int] = 24

# Интервал автоматической очистки временных файлов (секунды, 1 час)
TEMP_FILES_CLEANUP_INTERVAL: Final[int] = 3600


# ============================================================
# RATE LIMITING
# ============================================================

# Базовый rate limit: сообщений в секунду для обычных пользователей
DEFAULT_RATE_LIMIT: Final[float] = 0.5

# Rate limit для premium пользователей
PREMIUM_RATE_LIMIT: Final[float] = 2.0

# Rate limit для генерации ТЗ (запросов в минуту)
GENERATION_RATE_LIMIT_PER_MINUTE: Final[int] = 5


# ============================================================
# PDF ЭКСПОРТ
# ============================================================

# Максимальная длина текста ТЗ для экспорта в PDF
MAX_TZ_LENGTH_FOR_PDF: Final[int] = 50000

# URL для скачивания шрифтов (fallback)
FALLBACK_FONT_URL: Final[str] = "https://cdn.jsdelivr.net/npm/dejavu-fonts-ttf@2.37.3/ttf"


# ============================================================
# СООБЩЕНИЯ
# ============================================================

# Максимальная длина сообщения Telegram (символов)
MAX_MESSAGE_LENGTH: Final[int] = 4096

# Максимальная длина caption для медиа-групп (символов)
MAX_CAPTION_LENGTH: Final[int] = 1024


# ============================================================
# API И ВНЕШНИЕ СЕРВИСЫ
# ============================================================

# Таймаут для запросов к внешним API (секунды)
API_REQUEST_TIMEOUT: Final[int] = 30

# Максимальное количество повторных попыток при ошибках API
MAX_API_RETRIES: Final[int] = 3


# ============================================================
# ЛОГИРОВАНИЕ
# ============================================================

# Уровень логирования по умолчанию
DEFAULT_LOG_LEVEL: Final[str] = "INFO"

# Максимальное количество записей в логах админ-действий для отображения
MAX_ADMIN_LOG_ENTRIES: Final[int] = 50


# ============================================================
# ВАЛИДАЦИЯ
# ============================================================

# Минимальная длина текста ТЗ
MIN_TZ_TEXT_LENGTH: Final[int] = 100

# Максимальное количество неудачных попыток перед временной блокировкой
MAX_FAILED_ATTEMPTS: Final[int] = 5

# Время временной блокировки после неудачных попыток (секунды, 15 минут)
FAILED_ATTEMPTS_BLOCK_DURATION: Final[int] = 900


# ============================================================
# СТАТИСТИКА И АНАЛИТИКА
# ============================================================

# Период для расчета "активного пользователя" (дни)
ACTIVE_USER_PERIOD_DAYS: Final[int] = 7

# Периоды для аналитики доходов (дни)
ANALYTICS_REVENUE_PERIODS: Final[list] = [7, 30, 90, 365]
